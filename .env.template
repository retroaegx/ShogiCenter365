# ========== 共通で読む .env（DEV_* / PROD_* を完全分離） ==========
# 使い方:
#   1) このファイルを .env にコピー
#   2) REQUIRED と書いてある項目を自分の環境に合わせて設定

# フロントのビルド出力ディレクトリ（相対/絶対どちらでもOK）
SHOGI_FRONT_DIST=frontend/shogi-frontend/dist


# --------------------------- Development 専用 ---------------------------
# バックエンド bind / port（dev.py が DEV_* を無印に写して起動します）
DEV_HOST=0.0.0.0
DEV_PORT=5001

# Flask/JWT（開発用なので弱い値でOK）
DEV_SECRET_KEY=dev
DEV_JWT_SECRET_KEY=dev

# DB
DEV_MONGODB_URI=mongodb://localhost:27017/shogi
DEV_REDIS_URL=redis://localhost:6379/0

# CORS / メールリンク生成用URL
DEV_CORS_ORIGINS=http://localhost:5001
DEV_FRONTEND_URL=http://localhost:5001

# ---- 公開サイト（フロント）CIDR制限（dev）----
# 1=制限しない（公開向け） / 0=許可CIDRのみ
DEV_PUBLIC_SITE_ALLOW_REMOTE=1
# フロント公開を LAN/VPN 内に絞るときに使います（現在の実値をテンプレート化）
DEV_PUBLIC_SITE_ALLOWED_CIDRS=127.0.0.1/32,::1/128,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,fd00::/8,fe80::/10
# 逆プロキシ配下で X-Forwarded-For を信用するなら 1
DEV_PUBLIC_SITE_TRUST_PROXY=0


# メール認証
# DEV_REQUIRE_EMAIL_VERIFICATION=1
# 1=メール認証必須,0=不要,未設定=SMTP有効時のみ必須

# ---- SMTP（メール送信。設定すると送信有効）----
# DEV_SMTP_SERVER=smtp.example.com
# DEV_SMTP_PORT=587
# DEV_SMTP_USERNAME=
# DEV_SMTP_SENDER_EMAIL=no-reply@example.com
# DEV_SMTP_SENDER_PASSWORD=CHANGE_ME
# DEV_SMTP_SENDER_NAME=将棋センター365
# DEV_SMTP_USE_SSL=0
# DEV_SMTP_USE_STARTTLS=1
# DEV_SMTP_TIMEOUT_SEC=10

# 問い合わせメールの送信先（問い合わせ機能を使うなら設定推奨）
# DEV_CONTACT_RECEIVER_EMAIL=support@example.com

# ---- 管理サイト（開発用）----
# 既定: 127.0.0.1:5003（LANで開けるなら BIND=0.0.0.0 + CIDR を調整）
DEV_ADMIN_SITE_ENABLED=1
DEV_ADMIN_SITE_BIND=127.0.0.1
DEV_ADMIN_SITE_PORT=5003
DEV_ADMIN_SITE_ALLOWED_CIDRS=127.0.0.1/32,::1/128,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,fd00::/8,fe80::/10
# 逆プロキシ配下で X-Forwarded-For を信用するなら 1
DEV_ADMIN_SITE_TRUST_PROXY=0
# 1 にすると CIDR 制限を無効化（基本は 0 推奨）
DEV_ADMIN_SITE_ALLOW_REMOTE=0
DEV_ADMIN_SITE_STARTUP_TIMEOUT_SEC=5

# 管理ログイン（未設定だと管理サイトは起動スキップされます）
DEV_ADMIN_SITE_USERNAME=admin
DEV_ADMIN_SITE_PASSWORD=admin

# 解析サーバ（開発用）
DEV_ENGINE_SERVER_ENABLED=1
DEV_ENGINE_SERVER_AUTOSTART=1
DEV_ENGINE_SERVER_BIND=127.0.0.1
DEV_ENGINE_SERVER_PORT=5002
DEV_ENGINE_SERVER_URL=http://127.0.0.1:5002/analyze
DEV_ENGINE_SERVER_LOG_LEVEL=info
DEV_ENGINE_SERVER_STARTUP_TIMEOUT_SEC=8
# 解析サーバ: アクセス制限（同一ネットワーク向け。既定で LAN/VPN を許可）
DEV_ENGINE_SERVER_ALLOW_REMOTE=0
DEV_ENGINE_SERVER_ALLOWED_CIDRS=127.0.0.1/32,::1/128,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,fd00::/8,fe80::/10
# 逆プロキシ配下で X-Forwarded-For を信用するなら 1
DEV_ENGINE_SERVER_TRUST_PROXY=0
DEV_ENGINE_HTTP_TIMEOUT_SEC=30
DEV_ENGINE_THINK_SECONDS=1.0
DEV_ENGINE_MULTIPV=1

# やねうら王 / NNUE（開発用）
DEV_YANEO_SERVER_BASE_DIR=
# ↑ 任意（未設定ならプロジェクト直下基準）。systemd等で cwd が変わる環境なら設定推奨。
DEV_YANEO_ENGINE_DIR=engine
DEV_YANEO_ENGINE_BIN=YaneuraOu-by-gcc
DEV_YANEO_ENGINE_PATH=
# ↑ 任意（フルパス/相対どちらでも）。ENGINE_DIR 直下の bin を使うなら空でOK。
DEV_YANEO_EVAL_DIR=eval
DEV_YANEO_ENGINE_INSTANCES=4
DEV_YANEO_ENGINE_THREADS=1
DEV_YANEO_ENGINE_HASH_MB=1024
DEV_YANEO_FV_SCALE=20


# --------------------------- Production 専用 ---------------------------
# バックエンド bind / port（serve_eventlet.py が PROD_* を無印に写して起動します）
PROD_HOST=0.0.0.0
PROD_PORT=5000

# REQUIRED: 本番は必須（安全なランダム値にする）
PROD_SECRET_KEY=CHANGE_ME_STRONG_RANDOM
PROD_JWT_SECRET_KEY=CHANGE_ME_STRONG_RANDOM

# DB（必要なら変更）
PROD_MONGODB_URI=mongodb://localhost:27017/shogi
PROD_REDIS_URL=redis://localhost:6379/0

# REQUIRED: 公開URL（CORS / メールリンク生成に使う）
PROD_CORS_ORIGINS=https://example.com
PROD_FRONTEND_URL=https://example.com

# ---- 公開サイト（フロント）CIDR制限（prod）----
# 1=制限しない（公開向け） / 0=許可CIDRのみ
PROD_PUBLIC_SITE_ALLOW_REMOTE=1
# フロント公開を LAN/VPN 内に絞るときに使います（現在の実値をテンプレート化）
PROD_PUBLIC_SITE_ALLOWED_CIDRS=127.0.0.1/32,::1/128,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,fd00::/8,fe80::/10
# 逆プロキシ配下で X-Forwarded-For を信用するなら 1
PROD_PUBLIC_SITE_TRUST_PROXY=0


# メール認証
PROD_REQUIRE_EMAIL_VERIFICATION=1

# ---- SMTP（メール送信。メール機能を使うなら REQUIRED）----
# PROD_SMTP_SERVER=smtp.example.com
# PROD_SMTP_PORT=465
# PROD_SMTP_USERNAME=no-reply@example.com
# PROD_SMTP_SENDER_EMAIL=no-reply@example.com
# PROD_SMTP_SENDER_PASSWORD=CHANGE_ME
# PROD_SMTP_SENDER_NAME=将棋センター365
# PROD_SMTP_USE_SSL=1
# PROD_SMTP_USE_STARTTLS=0
# PROD_SMTP_TIMEOUT_SEC=10

# 問い合わせメールの送信先（問い合わせ機能を使うなら REQUIRED）
# PROD_CONTACT_RECEIVER_EMAIL=support@example.com

# ---- 管理サイト（本番）----
# REQUIRED: 公開するなら必ず CIDR を絞って、ログイン情報も変更
PROD_ADMIN_SITE_ENABLED=1
PROD_ADMIN_SITE_BIND=127.0.0.1
PROD_ADMIN_SITE_PORT=5003
PROD_ADMIN_SITE_ALLOWED_CIDRS=127.0.0.1/32,::1/128,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,fd00::/8,fe80::/10
PROD_ADMIN_SITE_TRUST_PROXY=0
PROD_ADMIN_SITE_ALLOW_REMOTE=0
PROD_ADMIN_SITE_STARTUP_TIMEOUT_SEC=5

# REQUIRED: 管理ログイン（未設定だと管理サイトは起動スキップされます）
PROD_ADMIN_SITE_USERNAME=CHANGE_ME_ADMIN
PROD_ADMIN_SITE_PASSWORD=CHANGE_ME_ADMIN_PASSWORD

# 解析サーバ（本番）
PROD_ENGINE_SERVER_ENABLED=1
PROD_ENGINE_SERVER_AUTOSTART=1
PROD_ENGINE_SERVER_BIND=127.0.0.1
PROD_ENGINE_SERVER_PORT=5002
PROD_ENGINE_SERVER_URL=http://127.0.0.1:5002/analyze
PROD_ENGINE_SERVER_LOG_LEVEL=info
PROD_ENGINE_SERVER_STARTUP_TIMEOUT_SEC=8
# 解析サーバ: アクセス制限（同一ネットワーク向け。既定で LAN/VPN を許可）
PROD_ENGINE_SERVER_ALLOW_REMOTE=0
PROD_ENGINE_SERVER_ALLOWED_CIDRS=127.0.0.1/32,::1/128,192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,fd00::/8,fe80::/10
# 逆プロキシ配下で X-Forwarded-For を信用するなら 1
PROD_ENGINE_SERVER_TRUST_PROXY=0
PROD_ENGINE_HTTP_TIMEOUT_SEC=30
PROD_ENGINE_THINK_SECONDS=1.0
PROD_ENGINE_MULTIPV=1
# ↑ multipv は int 扱い（整数）。

# 解析進捗/デバッグ
ANALYSIS_UPDATES_MODE=full
ANALYSIS_DB_DEBUG_LEVEL=basic

# やねうら王 / NNUE（本番）
PROD_YANEO_SERVER_BASE_DIR=
PROD_YANEO_ENGINE_DIR=engine
PROD_YANEO_ENGINE_BIN=YaneuraOu-by-gcc
PROD_YANEO_ENGINE_PATH=
PROD_YANEO_EVAL_DIR=eval
PROD_YANEO_ENGINE_INSTANCES=4
PROD_YANEO_ENGINE_THREADS=1
PROD_YANEO_ENGINE_HASH_MB=1024
PROD_YANEO_FV_SCALE=20


# --------------------------- OAuth（Google） ---------------------------
# Googleログインを使うなら REQUIRED。
# フロント（Vite）用
VITE_GOOGLE_CLIENT_ID=CHANGE_ME_GOOGLE_CLIENT_ID

# バックエンド用（未設定なら VITE_GOOGLE_CLIENT_ID を参照する実装）
GOOGLE_CLIENT_ID=${VITE_GOOGLE_CLIENT_ID}

# 現状コードでは未使用（将来の OAuth コード交換フロー用に取っておくなら）
# GOOGLE_CLIENT_SECRET=CHANGE_ME_GOOGLE_CLIENT_SECRET


# --------------------------- フロント（Vite）任意 ---------------------------
# フロントは通常 frontend/shogi-frontend 側で .env.* を読むので、
# ここに置いて効かない場合は「ビルド時の環境変数」として渡すか
# frontend/shogi-frontend/.env.local に同名を置いてね。

# APIのURLを固定したい場合（未設定なら window.location.origin を基準にします）
# VITE_API_BASE_URL=http://localhost:5001


# --------------------------- 共通（無印。dev/prod 両方で参照） ---------------------------
# 管理サイトのセッション鍵（未設定なら SECRET_KEY を使います）
# ADMIN_SITE_SECRET_KEY=CHANGE_ME_ADMIN_SITE_SECRET

# 管理サイト: ユーザー一覧の警告メッセージ（任意）
# ADMIN_SITE_DEFAULT_WARNING_MESSAGE=運営からの警告です。利用規約をご確認ください。

# 管理サイト: ブログ画像などのアップロード削除を許可（危険なので既定OFF）
# ADMIN_SITE_DELETE_UPLOADS=0

# 管理サイト: 公開側（通常は本体サイト）のURL生成に使う
# - どちらかを設定
#   - PUBLIC_SITE_BASE_URL（推奨: 例 https://example.com）
#   - BLOG_PUBLIC_BASE_URL（旧名）
# - 未設定のときは http://localhost:<PUBLIC_SITE_PORT> を使います
# PUBLIC_SITE_BASE_URL=https://example.com
# BLOG_PUBLIC_BASE_URL=https://example.com
# PUBLIC_SITE_PORT=5000

# ブログアップロード保存先（未設定なら <project>/blog_uploads）
# BLOG_UPLOAD_DIR=/var/lib/shogi/blog_uploads

# engine_server の追加挙動（必要なときだけ）
# ENGINE_GO_MODE=movetime
# ENGINE_VERIFY_POSITION=0
# ENGINE_HTTP_RETRY_TOTAL_SEC=10

# 解析workerの送信頻度（必要なときだけ）
# ANALYSIS_EMIT_EVERY_N=10
# ANALYSIS_EMIT_GAME_UPDATE=1
# ANALYSIS_EMIT_INITIAL_STATUS=0

# 共通セキュリティ（本番では変更推奨。Config.PEPPER の値）
# PEPPER=CHANGE_ME_PEPPER

# ======================================================================
